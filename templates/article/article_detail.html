<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>상세페이지</title>
    <!-- favicon -->
    <link rel="shortcut icon" href="../../static/img/favicon.png"/>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
            crossorigin="anonymous"
    />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
            crossorigin="anonymous"></script>
</head>
<style>
    @media (max-width: 1400px) {
        .menu-none {
            display: none;
        }

    }

    @media (max-width: 790px) {
        .menu-live {
            display: none;
        }
    }

    @media (max-width: 1620px) {

        .detail {
            max-width: 100%;
            width: auto !important;
            height: auto;
        }

        .wrap {
            max-width: 100%;
            width: auto !important;
            height: auto;
        }
    }

    @media (max-width: 1278px) {
        .else {
            display: none;
        }

    }

    @media (max-width: 810px) {
        .comment-box {
            max-width: 100%;
            width: auto !important;
            height: auto;
        }

        .poster > img {
            max-width: 100%;
            width: 450px !important;
            height: 700px;
        }
    }

    .navbar > img {
        margin-left: 30px;
        width: 130px;
        height: 45px;
    }

    body {
        background-image: linear-gradient(0deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5));
        background-color: #333333;
    }

    .header {
        z-index: 1;
        height: 80px;
        width: 100%;
        position: fixed;
        display: flex;
        top: 0;
        flex-direction: row;
        background-image: linear-gradient(to bottom, rgba(0, 0, 0, .7) 10%, rgba(0, 0, 0, 0));
        background-color: rgb(20, 20, 20);
    }

    .menu {
        margin-top: 28px;
        word-spacing: 150px;
        margin-left: 50px;
    }

    .menu > a {
        text-decoration: none;
    }

    .modal-post {
        color: ivory;
        cursor: pointer;
    }

    .modal-footer > button {
        background-color: black;
        color: ivory;
    }

    .detail {
        position: relative;
        margin: auto;
        display: flex;
        flex-direction: row;

    }

    .wrap {
        margin: auto;
        margin-top: 100px;
        text-align: left;
        border-radius: 5px;
        border: 2px dashed red;
        width: 1600px;
        height: 800px;

    }

    .poster {
        margin: auto;
        margin-top: 50px;
    }

    .poster > img {
        width: 450px;
        height: 700px;
        margin: auto;
    }

    .else {
        width: 600px;
        height: 500px;
        margin-top: 150px;
        font-size: 20px;
        margin-left: 100px;
        color: ivory;
    }

    .else > p {
        width: 500px;
    }

    .zzim {
        text-align: center;
        width: 110px;
        height: 40px;
        margin-left: 500px;
        background-color: crimson;
        position: absolute;
        margin-top: 50px;
    }

    .comment-box {
        width: 800px;
        margin: auto;
        display: flex;
        flex-direction: column;
        margin-top: 80px;
    }

    .media-body {
        margin-bottom: 20px;
    }

    .search {
        display: flex;
        flex-direction: row;
    }

    .search-btn {
        margin-top: 26px;
        height: 40px;
        background-color: red;
        color: ivory;
        width: 50px;
    }

    .comment-list {
        color: ivory;
    }

    .red-box {
        margin: auto;
    }
</style>
<body>
<div class="header">
    <a href="/" class="navbar">
        <img src=../static/img/logo.png>
    </a>
    <p class="menu menu-none">
        <a href="/" style="color: white; width: 30px"> 홈 </a>
    </p>
    <p class="menu menu-none">
        <a href="/like" style=" color:white;width: 120px; display: block "> 내가찜한콘텐츠 </a>
    </p>
    <p class="menu menu-live">
        <a href="/logout" style=" color: white; width: 70px; display: block"> 로그아웃 </a>
    </p>
    <p class="menu menu-live">
        <a class="modal-post" data-bs-toggle="modal" data-bs-target="#exampleModal"
           data-bs-whatever="@fat" style="color: white;  width: 80px; display: block">게시물작성
        </a>
    </p>
    <p class="menu menu-none">
        <a style="word-spacing:50px; color: white; display: block; width: 40px; display: block"
           href="{% url 'tag_cloud' %}">태그</a>
    </p>
    <form class="search" action="/search/" method="post">
        <div class="search">
            {% csrf_token %}
            <input class="form-control me-2 menu"
                   style="width: 265px; height: 35px;"
                   type="search" placeholder="검색" aria-label="Search" name="search" id="search">
            <button class="search-btn">검색</button>
        </div>
    </form>
</div>
<div class="wrap">
    <div class="red-box">
        <div class="detail">
            <div class="poster">
                <img src="../../media/{{ article.poster }}">
            </div>
        <div>
            {% if like %}
                <button class="zzim"><a href="/article/like/{{ article.id }}" class="card-link"
                                        style="color: ivory; text-decoration-color: transparent;">[찜 취소]</a>
                </button>
            {% else %}
                <button class="zzim"><a href="/article/like/{{ article.id }}" class="card-link"
                                        style="color: ivory; text-decoration-color: transparent;">[찜]</a>
                </button>
            {% endif %}
        </div>
            <div class="else">
                <p>제목 : {{ article.title }}</p>
                <p>연령 : {{ article.aged }}세 미만 시청 불가</p>
                <p>방영일 : {{ article.aired_date|date:"Y-m-d" }}</p>
                <p>등장인물 : {{ article.cast }}</p>
                <p>에피소드 수 : {{ article.episode }}</p>
                <p>장르 : {{ article.genre }}</p>
                {% if article.rating >= 0 and article.rating < 1 %}
                    <p>별점 : ☆☆☆☆☆ {{ article.rating }} </p>
                {% elif article.rating >= 1 and article.rating < 2 %}
                    <p>별점 : ★☆☆☆☆ {{ article.rating }} </p>
                {% elif article.rating >= 2 and article.rating < 3 %}
                    <p>별점 : ★★☆☆☆ {{ article.rating }} </p>
                {% elif article.rating >= 3 and article.rating < 4 %}
                    <p>별점 : ★★★☆☆ {{ article.rating }} </p>
                {% elif article.rating >= 4 and article.rating < 5 %}
                    <p>별점 : ★★★★☆ {{ article.rating }} </p>
                {% elif article.rating == 5 %}
                    <p>별점 : ★★★★★ {{ article.rating }} </p>
                {% endif %}
                <p>줄거리 : {{ article.synopsis }}</p>
                <p>태그 : </p>
                {% if article.tags.all %}
                    {% for tag in article.tags.all %}
                        <a style="text-decoration: none"
                           href="{% url 'tagged_object_list' tag.name %}">
                                                    <span class="badge rounded-pill bg-success">
                                                        {{ tag.name }}
                                                    </span>
                        </a>
                    {% endfor %}
                {% endif %}

            </div>

        </div>
    </div>
</div>
<div class="comment-box">
    <div class="comment">
        <form class="comment-input input-group mb-3" action="/article/comment/{{ article.id }}" method="post">
            {% csrf_token %}
            <input type="text" class="form-control" id='comment' name='comment' placeholder="댓글을 작성 해 주세요"/>
            <select name="rating" id="rating">
                <option value="1">★</option>
                <option value="2">★★</option>
                <option value="3">★★★</option>
                <option value="4">★★★★</option>
                <option value="5">★★★★★</option>
            </select>
            <button class="btn btn-outline-secondary" type="submit">작성</button>
        </form>
    </div>
    <div class="comment-list">
        {% for cm in comment %}
            <div class="row">
                <div class="col-md-12">
                    <div class="media">
                        <div class="media-body">
                            <h5 class="mt-0"> {{ cm.comment }} </h5>
                            {% if cm.rating == 1 %}
                                <p>★☆☆☆☆</p>
                            {% elif cm.rating == 2 %}
                                <p>★★☆☆☆</p>
                            {% elif cm.rating == 3 %}
                                <p>★★★☆☆</p>
                            {% elif cm.rating == 4 %}
                                <p>★★★★☆</p>
                            {% elif cm.rating == 5 %}
                                <p>★★★★★</p>
                            {% endif %}
                            <span> {{ cm.author }} </span>
                            <span> - {{ cm.created_at | timesince }} 전</span>
                        </div>
                        {% if cm.author == user %}
                            <div style="float: right">
                                <a href="/article/comment/delete/{{ cm.id }}">
                                    <span class="badge bg-danger">삭제</span>
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
</div>

</form>
<div id="upload">
    <form class="form-area" method="post" action="/article/">
        {% csrf_token %}
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">게시물 생성하기</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form class="form-area" method="post" action="/article/">
                        <div class="modal-body">
                            {% csrf_token %}
                            <div class="form-group mt-2 mb-2">
                                <label for="username">제목</label>
                                <input type="text" class="form-control" id="title" name="title">
                            </div>
                            <div class="form-group mt-2 mb-2">
                                <label for="username">이미지</label>
                                <input type="file" accept="image/*" required
                                       id="poster" name="poster"/>
                            </div>
                            <div class="form-group mt-2 mb-2">
                                <label for="password">줄거리</label>
                                <input type="text" class="form-control" id="synopsis" name="synopsis">
                            </div>
                            <div class="form-group mt-2 mb-2">
                                <label for="password">장르</label>
                                <input type="text" class="form-control" id="genre" name="genre">
                            </div>
                            <div class="form-group mt-2 mb-2">
                                <label for="password">태그</label>
                                <input type="text" class="form-control" id="tags" name="tags">
                            </div>
                            <div class="form-group mt-2 mb-2">
                                <label for="password">캐스팅 배우</label>
                                <input type="text" class="form-control" id="cast" name="cast">
                            </div>
                            <div class="form-group mt-2 mb-2">
                                <label for="password">출시일</label>
                                <input type="date" class="form-control" id="aired_date" name="aired_date">
                            </div>
                            <div class="form-group mt-2 mb-2">
                                <label for="password">에피소드 수</label>
                                <input type="number" class="form-control" id="episode" name="episode">
                            </div>
                            <div class="form-group mt-2 mb-2">
                                <label for="password">연령제한 (15 or 19)</label>
                                <select class="form-control" id="aged" name="aged" required>
                                    <option value="15">15세미만 관람불가</option>
                                    <option value="19">19세미만 관람불가</option>
                                    <option value="" disabled selected>연령제한을 선택해 주세요.</option>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="modal-post" data-bs-dismiss="modal">닫기</button>
                            <button type="submit" class="modal-post">생성</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </form>
</div>
</body>
</html>